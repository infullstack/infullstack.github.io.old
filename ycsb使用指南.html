<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="description" content="I am a full stack engineer, working on big data."><meta name="keyword"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>ycsb使用指南</title><link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon"><link href="/styles/site.css" rel="stylesheet"></head><body><header class="container" id="header"><div class="header"><div class="header-left"><div class="avatar"><img src="/images/avatar-min.png"></div><div class="author"><div class="author-name"><a href="/">Ray</a></div><div class="about-me">Halo~ ，Just a Product Manager Blog</div></div></div><div class="header-right"><ul class="navigation"><li><a href="/archives">归档</a></li></ul></div><div class="about-me-mask"><div class="about-me-wrap"><div class="about-me__header"><div class="avatar"><img src="/images/avatar-min.png"></div></div><ul class="socials"><li class="social-item"><span class="label"><img src="/images/socials/github.svg" alt="https://github.com/infullstack"></span><a href="https://github.com/infullstack" target="_blank" title="https://github.com/infullstack">https://github.com/infullstack</a></li><li class="social-item"><span class="label"><img src="/images/socials/email.svg" alt="infullstack@163.com"></span><span>infullstack@163.com</span></li><li class="social-item"><span class="label"><img src="/images/socials/wechat.svg" alt="onlyyanlei"></span><span>onlyyanlei</span></li></ul></div></div></div></header><div class="container post"><section class="article"><div class="title">ycsb使用指南</div><div class="date">写于2018年01月17日</div><div class="content"><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>YCSB（Yahoo! Cloud Serving Benchmark）是雅虎开源的一款通用的性能测试工具。<br>通过这个工具我们可以对各类NoSQL产品进行相关的性能测试，包括：PNUTS、BigTable 、HBase、Hypertable、Azure、Cassandra、CouchDB、Voldemort、MongoDb、Dynomite。<br><a id="more"></a><br>YCSB与HBase自带的性能测试工具（PerformanceEvaluation）相比，好处在于：</p>
<ul>
<li>扩展：进行性能测试的客户端不仅仅只是HBase一款产品，而且可以是HBase不同的版本。</li>
<li>灵活：进行性能测试的时候，可以选择进行测试的方式：read+write，read+scan等，还可以选择不同操作的频度与选取Key的方式。</li>
<li>监控：进行性能测试的时候，可以实时显示测试进行的进度：</li>
</ul>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>下载ycsb 0.6压缩包，解压即可<br><a href="https://github.com/brianfrankcooper/YCSB/releases/download/0.6.0/ycsb-0.6.0.tar.gz" target="_blank" rel="noopener">https://github.com/brianfrankcooper/YCSB/releases/download/0.6.0/ycsb-0.6.0.tar.gz</a></p>
<p>注：执行ycsb时，如果报python argparse模块异常，因为python版本低，需要安装python argparse模块 ，解压进入执行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python setup.py install</span><br></pre></td></tr></table></figure></p>
<p>创建Hbase表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">n_splits = 200 </span><br><span class="line">create &apos;usertable&apos;, &apos;family&apos;, &#123;SPLITS =&gt; (1..n_splits).map &#123;|i| &quot;user#&#123;1000+i*(9999-1000)/n_splits&#125;&quot;&#125;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="参数配置"><a href="#参数配置" class="headerlink" title="参数配置"></a>参数配置</h3><p>Ycsb的执行配置在workload文件下，可以参考workloada和workload_template配置文件</p>
<ul>
<li><p>Load配置<br>Workload文件夹下新建workload_load文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#记录数</span><br><span class="line">recordcount=10000000</span><br><span class="line">#操作记录数</span><br><span class="line">operationcount=10000000</span><br><span class="line"># 测试类</span><br><span class="line">workload=com.yahoo.ycsb.workloads.CoreWorkload</span><br><span class="line">readallfields=true</span><br><span class="line"># read比例</span><br><span class="line">readproportion=0</span><br><span class="line"># update比例</span><br><span class="line">updateproportion=0</span><br><span class="line"># scan比例</span><br><span class="line">scanproportion=0</span><br><span class="line"># Load比例</span><br><span class="line">insertproportion=1</span><br><span class="line">requestdistribution=zipfian</span><br><span class="line"># The number of fields in a record</span><br><span class="line">fieldcount=10</span><br><span class="line"># The size of each field (in bytes)</span><br><span class="line">fieldlength=100</span><br><span class="line"># hbase表</span><br><span class="line">table=usertable</span><br><span class="line">columnfamily=family</span><br></pre></td></tr></table></figure>
</li>
<li><p>Scan配置<br>Workload文件夹下新建workload_scan文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">recordcount=10000000</span><br><span class="line">operationcount=10000000</span><br><span class="line">workload=com.yahoo.ycsb.workloads.CoreWorkload</span><br><span class="line">readallfields=true</span><br><span class="line">readproportion=0</span><br><span class="line">updateproportion=0</span><br><span class="line">scanproportion=1</span><br><span class="line">insertproportion=0</span><br><span class="line">requestdistribution=zipfian</span><br><span class="line">table=usertable</span><br><span class="line">columnfamily=family</span><br><span class="line">#必填</span><br><span class="line">hbase.usepagefilter=false</span><br></pre></td></tr></table></figure>
</li>
<li><p>Read配置<br>Workload文件夹下新建workload_read文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">recordcount=10000000</span><br><span class="line">operationcount=10000000</span><br><span class="line">workload=com.yahoo.ycsb.workloads.CoreWorkload</span><br><span class="line">readallfields=true</span><br><span class="line">readproportion=1</span><br><span class="line">updateproportion=0</span><br><span class="line">scanproportion=0</span><br><span class="line">insertproportion=0</span><br><span class="line">requestdistribution=zipfian</span><br><span class="line">table=usertable</span><br><span class="line">columnfamily=family</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><ul>
<li><p>Load</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/ycsb load hbase098 -P workloads/workload_load -cp hbase098-binding/conf –threads 100</span><br></pre></td></tr></table></figure>
</li>
<li><p>Scan</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/ycsb load hbase098 -P workloads/workload_scan -cp hbase098-binding/conf –threads 100</span><br></pre></td></tr></table></figure>
</li>
<li><p>Read</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/ycsb load hbase098 -P workloads/workload_read -cp hbase098-binding/conf –threads 100</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>测试的时候可以在集群的节点上启多个客户端执行ycsb测试，如：Load测试，集群5个节点，各启动10个客户端，每个客户端启动100个线程，总共是5000个线程执行Load</p>
</div><div class="tags"><a class="tag-link" href="/tags/hbase/">hbase</a><a class="tag-link" href="/tags/ycsb/">ycsb</a><a class="tag-link" href="/tags/性能/">性能</a><a class="tag-link" href="/tags/测试/">测试</a></div></section></div><div class="container"><ul class="nav"><li>上一篇：<a href="/我的博客史.html">我的博客史</a></li><li>下一篇：<a href="/kerberos定时登录设置.html">kerberos定时登录设置</a></li></ul></div><div id="backToTop"><div class="back-arrow back-arrow-left"></div><div class="back-arrow back-arrow-right"></div></div><footer class="container"><div class="rights"><span>Powered by </span><a href="http://hexo.io" target="_blank">Hexo</a><span>, Theme </span><a href="https://github.com/gary-Shen/hexo-theme-curry" target="_blank">Curry</a><span>.</span></div></footer><script src="/script/jquery.min.js"></script><link rel="stylesheet" href="/fancybox/jquery.fancybox.css"><script src="/fancybox/jquery.fancybox.pack.js"></script><script src="/script/index.js"></script><script src="/script/post.js"></script></body></html>